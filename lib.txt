This is some lib
Modification from master here